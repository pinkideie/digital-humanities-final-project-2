<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Digital Dilemmas</title>
  <style>
    body { font-family: Georgia, serif; background: #f4f4f4; color: #333; max-width: 700px; margin: auto; }
    .choice { margin: 1em 0; }
    button { margin: 0.5em; }
  </style>
</head>
<body>
  <h1>Digital Dilemmas: A Civic Responsibility Game</h1>
  <div id="game"></div>

  <script>
    // Simple state tracking
    let empathy = 0;
    let exploitation = 0;

    // Passages as plain JS objects
    const passages = {
      start: {
        text: "You are a digital citizen navigating a world shaped by invisible algorithms, global labor, and persuasive data. Your choices will define your ethical compass.",
        choices: [
          { text: "Begin your journey", next: "cobalt" }
        ]
      },
      cobalt: {
        text: "You are offered a new smartphone at a steep discount. But you learn it may be sourced from cobalt mined by children in the Congo.",
        choices: [
          { text: "Buy the phone anyway", next: "buyPhone", effect: () => exploitation++ },
          { text: "Refuse and support ethical tech", next: "ethicalTech", effect: () => empathy++ }
        ]
      },
      buyPhone: {
        text: "You buy the phone. It's fast and sleek. But a part of you wonders about the cost.",
        choices: [{ text: "Next", next: "chatbot" }]
      },
      ethicalTech: {
        text: "You choose a more expensive but ethically sourced device. It feels right.",
        choices: [{ text: "Next", next: "chatbot" }]
      },
      chatbot: {
        text: "You interact with Arya, a chatbot used by your city to allocate housing. It denies your application with no explanation.",
        choices: [
          { text: "Accept the decision", next: "acceptChatbot", effect: () => exploitation++ },
          { text: "Challenge the algorithm", next: "challengeChatbot", effect: () => empathy++ }
        ]
      },
      acceptChatbot: {
        text: "You accept the decision. Life goes on, but you feel powerless.",
        choices: [{ text: "Next", next: "covid" }]
      },
      challengeChatbot: {
        text: "You demand transparency. A public hearing is held. Others join your cause.",
        choices: [{ text: "Next", next: "covid" }]
      },
      covid: {
        text: "You see a COVID dashboard showing low infection rates. But you suspect the data is outdated and misleading.",
        choices: [
          { text: "Share it to reassure others", next: "shareDashboard", effect: () => exploitation++ },
          { text: "Investigate and publish your findings", next: "investigateDashboard", effect: () => empathy++ }
        ]
      },
      shareDashboard: {
        text: "You share the dashboard. People feel safe, but the virus spreads.",
        choices: [{ text: "See your outcome", next: "ending" }]
      },
      investigateDashboard: {
        text: "You expose the flaws. The dashboard is updated. Lives are saved.",
        choices: [{ text: "See your outcome", next: "ending" }]
      },
      ending: {
        text: () => {
          if (empathy > exploitation) {
            return "You chose empathy and civic responsibility. Your actions sparked change and inspired others.";
          } else {
            return "You chose comfort and convenience. The world moved on, but at what cost?";
          }
        },
        choices: []
      }
    };

    function showPassage(name) {
      const passage = passages[name];
      const gameDiv = document.getElementById("game");
      gameDiv.innerHTML = "";

      const text = typeof passage.text === "function" ? passage.text() : passage.text;
      const p = document.createElement("p");
      p.textContent = text;
      gameDiv.appendChild(p);

      passage.choices.forEach(choice => {
        const btn = document.createElement("button");
        btn.textContent = choice.text;
        btn.onclick = () => {
          if (choice.effect) choice.effect();
          showPassage(choice.next);
        };
        gameDiv.appendChild(btn);
      });
    }

    // Start the game
    showPassage("start");
  </script>
</body>
</html>
